name: Test SSH Connection (New)

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: 触发连接测试
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.DEPLOY_CENTER_PAT }}
          script: |
            console.log('🚀 开始触发连接测试...');
            console.log('目标仓库: MoseLu/axi-deploy');
            console.log('工作流: test-connection.yml');
            console.log('分支: master');
            
            const { data: response } = await github.rest.actions.createWorkflowDispatch({
              owner: 'MoseLu',
              repo: 'axi-deploy',
              workflow_id: 'test-connection.yml',
              ref: 'master',
              inputs: {
                caller_repo: '${{ github.repository }}',
                caller_branch: '${{ github.ref_name }}',
                caller_commit: '${{ github.sha }}'
              }
            });
            
            console.log('✅ 连接测试已触发:', response); 